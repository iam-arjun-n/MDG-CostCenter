sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/Fragment","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/FilterType","sap/m/Token","sap/m/MessageBox","sap/ui/model/json/JSONModel","sap/ui/export/Spreadsheet","com/deloitte/mdg/cost/center/costcenter/model/formatter"],function(e,t,r,o,n,s,a,i,d,u){"use strict";return e.extend("com.deloitte.mdg.cost.center.costcenter.controller.Overview",{formatter:u,onInit:function(){this._oModel=this.getView().getModel("costCenterModel");this._addCurrentUserToken()},_addCurrentUserToken:function(){var e=this.byId("filterbar");var t=this.byId("createdBy");var r=this.getOwnerComponent().getModel("userInfo")?.getProperty("/email");if(r){t.addToken(new s({text:r}))}},onGo:function(){var e=this.byId("Overview_Table");var t=e.getBinding("items");var s=[];var a=this.byId("requestId").getValue();if(a){s.push(new r("requestId",o.Contains,a))}var i=this.byId("requestType").getSelectedKey();if(i){s.push(new r("requestType",o.EQ,i))}var d=this.byId("workflowStatus").getSelectedKey();if(d){s.push(new r("workflowStatus",o.EQ,d))}var u=this.byId("createdBy");var l=u.getTokens();if(l.length>0){var c=l.map(function(e){return new r("createdByName",o.Contains,e.getText())});s.push(new r({filters:c,and:false}))}t.filter(s,n.Application)},onClear:function(){this.byId("requestId").setValue("");this.byId("requestType").setSelectedKey("");this.byId("workflowStatus").setSelectedKey("");var e=this.byId("createdBy");e.destroyTokens()},onRequestPress:function(e){var t=e.getSource().getBindingContext("costCenterModel");var r=t.getProperty("requestId");a.information("Request ID: "+r)},onCreatePress:function(){a.information("Create Cost Center triggered.")},onChangeExtendPress:function(){a.information("Change/Extend Cost Center triggered.")},onUpdateStarted:function(){},onRequestSelectionChange:function(e){var t=e.getParameter("listItem");if(!t)return;var r=t.getBindingContext("costCenterModel");console.log("Selected Request:",r.getProperty("requestId"))},onExport:function(){var e=this.byId("Overview_Table");var t=e.getBinding("items").getCurrentContexts().map(e=>e.getObject());if(!t||t.length===0){a.warning("No data to export.");return}var r=t.map(e=>({"Request ID":e.requestId,"Request Type":e.requestType,"Workflow Status":e.workflowStatus,"Created On":e.createdAt,"Created By":e.createdByName}));var o={workbook:{columns:[{label:"Request ID",property:"Request ID"},{label:"Request Type",property:"Request Type"},{label:"Workflow Status",property:"Workflow Status"},{label:"Created On",property:"Created On"},{label:"Created By",property:"Created By"}]},dataSource:r,fileName:"CostCenterRequests.xlsx"};var n=new d(o);n.build().finally(()=>{n.destroy()})}})});
//# sourceMappingURL=Overview.controller.js.map